Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
lr: 0.01
2.8539323806762695 0.07462787628173828
Epoch: [0][ 0/69]	Time  2.32 ( 2.32)	Data  1.16 ( 1.16)	Loss   2.93 (  2.93)
2.9478371143341064 0.0562434196472168
2.8654732704162598 0.08842611312866211
2.7654755115509033 0.09722661972045898
2.7203054428100586 0.0766134262084961
2.713705062866211 0.10319185256958008
2.6497178077697754 0.08810901641845703
2.376647472381592 0.13842058181762695
2.4037580490112305 0.1361832618713379
2.580155372619629 0.1394181251525879
2.531276226043701 0.08800840377807617
Epoch: [0][10/69]	Time  0.24 ( 0.43)	Data  0.09 ( 0.18)	Loss   2.62 (  2.77)
2.5610060691833496 0.11139535903930664
2.4784462451934814 0.1237330436706543
2.507723093032837 0.11925411224365234
2.3740158081054688 0.15090417861938477
2.1514759063720703 0.16187143325805664
2.102513074874878 0.1642603874206543
2.1666572093963623 0.19769001007080078
2.314357280731201 0.17874670028686523
2.0042896270751953 0.2017650604248047
2.185662031173706 0.18996930122375488
Epoch: [0][20/69]	Time  0.25 ( 0.34)	Data  0.09 ( 0.14)	Loss   2.38 (  2.62)
2.1500084400177 0.18707656860351562
2.2268567085266113 0.19982028007507324
2.22428822517395 0.17653512954711914
1.9792108535766602 0.23348307609558105
1.9354686737060547 0.2414107322692871
2.071009635925293 0.18872499465942383
1.8676378726959229 0.21281719207763672
1.8606057167053223 0.2738327980041504
1.9442451000213623 0.21703720092773438
2.0947928428649902 0.18486976623535156
Epoch: [0][30/69]	Time  0.25 ( 0.31)	Data  0.09 ( 0.13)	Loss   2.28 (  2.50)
1.8257479667663574 0.26885151863098145
2.1100642681121826 0.18620634078979492
2.000126838684082 0.2259962558746338
1.9541655778884888 0.24395084381103516
1.7804805040359497 0.2091078758239746
1.8767876625061035 0.24650812149047852
1.903247356414795 0.22740983963012695
1.923093557357788 0.20012784004211426
1.7040318250656128 0.28351521492004395
1.9371953010559082 0.2319495677947998
Epoch: [0][40/69]	Time  0.25 ( 0.29)	Data  0.09 ( 0.12)	Loss   2.17 (  2.41)
1.9547291994094849 0.2743656635284424
1.8539371490478516 0.24590539932250977
1.7481155395507812 0.29422640800476074
1.900881052017212 0.2258901596069336
1.6221835613250732 0.3505077362060547
1.9754048585891724 0.20133066177368164
1.5599908828735352 0.28050899505615234
1.6853704452514648 0.2928624153137207
1.784693956375122 0.293407678604126
1.8926687240600586 0.2620220184326172
Epoch: [0][50/69]	Time  0.25 ( 0.29)	Data  0.09 ( 0.11)	Loss   2.15 (  2.34)
1.8627992868423462 0.2569723129272461
1.7233009338378906 0.28012657165527344
1.6363940238952637 0.2907402515411377
1.8009278774261475 0.24605274200439453
1.8059312105178833 0.2215743064880371
1.6615437269210815 0.3123300075531006
1.7565529346466064 0.2914729118347168
1.696587085723877 0.2628209590911865
1.6418037414550781 0.2844996452331543
1.693263053894043 0.24691295623779297
Epoch: [0][60/69]	Time  0.25 ( 0.28)	Data  0.09 ( 0.11)	Loss   1.94 (  2.29)
1.7388722896575928 0.21173477172851562
1.5911883115768433 0.35218334197998047
1.4127126932144165 0.3105752468109131
1.8468539714813232 0.22249889373779297
1.587230920791626 0.31537508964538574
1.5742273330688477 0.27562618255615234
1.6198604106903076 0.2706179618835449
1.998192310333252 0.518885612487793
Test: [ 0/69]	Time  1.004 ( 1.004)	Loss 3.1316e+00 (3.1316e+00)	Acc@1  26.56 ( 26.56)
Test: [10/69]	Time  0.082 ( 0.168)	Loss 1.3147e+00 (2.2182e+00)	Acc@1  68.75 ( 50.28)
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 355, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 130, in main
    acc1 = utils.validate(val_loader, classifier, args, device)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/utils.py", line 193, in validate
    losses.update(loss.item(), images.size(0))
KeyboardInterrupt
