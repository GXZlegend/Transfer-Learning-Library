Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
lr: 0.01
2.9720468521118164 -4.104180335998535
Epoch: [0][ 0/69]	Time  2.01 ( 2.01)	Data  0.86 ( 0.86)	Loss  -1.13 ( -1.13)
2.6593716144561768 -4.035197734832764
2.8920395374298096 -4.097959995269775
2.9360427856445312 -4.117749214172363
2.756202220916748 -4.083794593811035
2.7242603302001953 -4.103231430053711
2.564279556274414 -4.0878448486328125
2.599184989929199 -4.056229591369629
2.714639186859131 -4.062829971313477
2.854621648788452 -4.108720302581787
2.380429267883301 -4.031822204589844
Epoch: [0][10/69]	Time  0.25 ( 0.40)	Data  0.10 ( 0.16)	Loss  -1.65 ( -1.35)
2.4393503665924072 -4.049737930297852
2.4145917892456055 -4.058852195739746
2.4286296367645264 -4.045454978942871
2.411616325378418 -4.016049385070801
2.2724509239196777 -4.022073745727539
2.345170021057129 -4.018476963043213
2.157599687576294 -3.996371269226074
2.283169746398926 -4.030117988586426
2.320956230163574 -3.993191719055176
2.1479711532592773 -3.9907050132751465
Epoch: [0][20/69]	Time  0.25 ( 0.33)	Data  0.09 ( 0.13)	Loss  -1.84 ( -1.52)
2.061213493347168 -3.9386701583862305
2.092700958251953 -3.983769655227661
2.209627389907837 -4.022479057312012
2.029503345489502 -3.98952317237854
2.141256332397461 -3.9938793182373047
1.8802179098129272 -3.9484448432922363
2.193537473678589 -4.001026153564453
2.163564920425415 -3.9864983558654785
2.050819158554077 -3.92464017868042
1.952246904373169 -3.959333896636963
Epoch: [0][30/69]	Time  0.24 ( 0.30)	Data  0.09 ( 0.12)	Loss  -2.01 ( -1.64)
2.1206183433532715 -3.985029458999634
1.7709428071975708 -3.957331657409668
1.8983776569366455 -3.9482710361480713
2.0515964031219482 -3.9851512908935547
2.0919744968414307 -3.991567611694336
1.8515902757644653 -3.933537721633911
1.916987657546997 -3.93791127204895
1.9270893335342407 -3.9328055381774902
2.0358238220214844 -3.9839205741882324
1.7886567115783691 -3.9182136058807373
Epoch: [0][40/69]	Time  0.24 ( 0.29)	Data  0.09 ( 0.11)	Loss  -2.13 ( -1.73)
1.8060485124588013 -3.9089558124542236
1.7865023612976074 -3.9085378646850586
1.6427044868469238 -3.8495521545410156
1.6037511825561523 -3.822159767150879
1.8275282382965088 -3.934936285018921
1.649559497833252 -3.9371156692504883
1.928117036819458 -3.977240800857544
1.6329020261764526 -3.894153118133545
1.8379631042480469 -3.8851351737976074
1.9610885381698608 -3.9557929039001465
Epoch: [0][50/69]	Time  0.24 ( 0.28)	Data  0.09 ( 0.11)	Loss  -1.99 ( -1.81)
1.5305471420288086 -3.827104330062866
1.625110149383545 -3.85819149017334
1.7406470775604248 -3.9281668663024902
1.610799789428711 -3.9085357189178467
1.7801259756088257 -3.919525623321533
1.7029924392700195 -3.8908121585845947
1.4223353862762451 -3.841735363006592
1.6238467693328857 -3.9251708984375
1.5326714515686035 -3.810927152633667
1.629901647567749 -3.870936155319214
Epoch: [0][60/69]	Time  0.24 ( 0.27)	Data  0.09 ( 0.10)	Loss  -2.24 ( -1.88)
1.6311038732528687 -3.8990328311920166
1.6332120895385742 -3.8883724212646484
1.5049567222595215 -3.828552722930908
1.4869232177734375 -3.864518642425537
1.8604470491409302 -3.921783924102783
1.3981530666351318 -3.8331799507141113
1.640651822090149 -3.9150166511535645
1.606979489326477 -3.46331787109375
Test: [ 0/69]	Time  1.027 ( 1.027)	Loss 3.0337e+00 (3.0337e+00)	Acc@1  26.56 ( 26.56)
Test: [10/69]	Time  0.083 ( 0.176)	Loss 1.3095e+00 (2.2408e+00)	Acc@1  71.88 ( 50.00)
Test: [20/69]	Time  0.080 ( 0.132)	Loss 4.8684e-01 (2.2795e+00)	Acc@1  90.62 ( 48.88)
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 355, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 130, in main
    acc1 = utils.validate(val_loader, classifier, args, device)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/utils.py", line 186, in validate
    output = model(images)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/tllib/modules/classifier.py", line 80, in forward
    f = self.pool_layer(self.backbone(x))
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/tllib/vision/models/resnet.py", line 34, in forward
    x = self.layer3(x)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/resnet.py", line 151, in forward
    out = self.bn2(out)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/modules/batchnorm.py", line 168, in forward
    return F.batch_norm(
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2438, in batch_norm
    return torch.batch_norm(
KeyboardInterrupt
