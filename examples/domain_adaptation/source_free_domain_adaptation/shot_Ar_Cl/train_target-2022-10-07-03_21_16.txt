Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
2.8985795974731445 0.0948495864868164
Epoch: [0][ 0/69]	Time  2.13 ( 2.13)	Data  0.95 ( 0.95)	Loss   2.99 (  2.99)
2.9453492164611816 0.05511808395385742
2.8063368797302246 0.09035921096801758
2.7705330848693848 0.09031343460083008
2.7490148544311523 0.06885099411010742
2.594407558441162 0.11438179016113281
2.294890880584717 0.1494288444519043
2.62292218208313 0.09056425094604492
2.542417526245117 0.13540029525756836
2.561939239501953 0.1108851432800293
2.534749746322632 0.14703845977783203
Epoch: [0][10/69]	Time  0.24 ( 0.41)	Data  0.09 ( 0.16)	Loss   2.68 (  2.77)
2.4534218311309814 0.11843299865722656
2.322103500366211 0.13184404373168945
2.4028186798095703 0.15593624114990234
2.3443613052368164 0.18047332763671875
2.422214984893799 0.12872552871704102
2.339366912841797 0.13599634170532227
2.4620018005371094 0.1294388771057129
2.5097103118896484 0.13778066635131836
2.4014344215393066 0.15730571746826172
2.2533516883850098 0.14368200302124023
Epoch: [0][20/69]	Time  0.24 ( 0.33)	Data  0.09 ( 0.13)	Loss   2.40 (  2.66)
1.9874106645584106 0.2593190670013428
2.0695576667785645 0.19042277336120605
2.0510661602020264 0.184356689453125
1.9929780960083008 0.22680187225341797
2.033088207244873 0.2187488079071045
2.1377785205841064 0.1805555820465088
2.161853313446045 0.20049691200256348
2.067150115966797 0.1917262077331543
1.9018723964691162 0.23398971557617188
1.9781084060668945 0.2336747646331787
Epoch: [0][30/69]	Time  0.24 ( 0.30)	Data  0.09 ( 0.12)	Loss   2.21 (  2.53)
1.8869571685791016 0.20808029174804688
1.7083218097686768 0.32709598541259766
2.0899617671966553 0.18684768676757812
1.9446966648101807 0.31051063537597656
1.9299509525299072 0.23978924751281738
1.7510912418365479 0.2653813362121582
2.109963893890381 0.21657991409301758
1.9129960536956787 0.2411351203918457
1.7844531536102295 0.23769664764404297
1.8603479862213135 0.25321340560913086
Epoch: [0][40/69]	Time  0.24 ( 0.29)	Data  0.09 ( 0.11)	Loss   2.11 (  2.43)
1.8579875230789185 0.27838945388793945
2.0050125122070312 0.2027430534362793
1.8939634561538696 0.22342777252197266
1.803457260131836 0.28285837173461914
1.6069015264511108 0.367063045501709
1.6927438974380493 0.2971944808959961
1.6115882396697998 0.259737491607666
1.5295100212097168 0.30812525749206543
1.6068165302276611 0.2992827892303467
1.4501378536224365 0.36015844345092773
Epoch: [0][50/69]	Time  0.25 ( 0.28)	Data  0.09 ( 0.11)	Loss   1.81 (  2.35)
1.7097352743148804 0.2680356502532959
1.666602373123169 0.3036050796508789
1.878519058227539 0.2331535816192627
1.6089227199554443 0.28883838653564453
1.7276244163513184 0.21645212173461914
1.9767107963562012 0.24249696731567383
1.466434359550476 0.35561060905456543
1.5377553701400757 0.35579633712768555
1.5069429874420166 0.3308558464050293
1.8476448059082031 0.3244013786315918
Epoch: [0][60/69]	Time  0.24 ( 0.27)	Data  0.09 ( 0.11)	Loss   2.17 (  2.29)
1.5881195068359375 0.2971158027648926
1.760331630706787 0.26316070556640625
1.4248548746109009 0.3583338260650635
1.7161829471588135 0.3195664882659912
1.712348461151123 0.351712703704834
1.3400895595550537 0.372072696685791
1.4818873405456543 0.4219822883605957
1.6869142055511475 0.6382744312286377
Test: [ 0/69]	Time  0.818 ( 0.818)	Loss 3.2176e+00 (3.2176e+00)	Acc@1  25.00 ( 25.00)
Test: [10/69]	Time  0.081 ( 0.150)	Loss 1.4782e+00 (2.2944e+00)	Acc@1  64.06 ( 49.57)
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 354, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 129, in main
    acc1 = utils.validate(val_loader, classifier, args, device)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/utils.py", line 193, in validate
    losses.update(loss.item(), images.size(0))
KeyboardInterrupt
