Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
lr: [0.001, 0.01]
2.8002824783325195 0.0977320671081543
Epoch: [0][ 0/69]	Time  2.14 ( 2.14)	Data  0.98 ( 0.98)	Loss   2.90 (  2.90)
2.6795144081115723 0.1128687858581543
2.8847739696502686 0.0726475715637207
2.808776378631592 0.07852458953857422
2.764787197113037 0.10320806503295898
2.909433126449585 0.08943986892700195
2.6220574378967285 0.09499883651733398
2.8079326152801514 0.08394336700439453
2.7001266479492188 0.10856389999389648
2.424349308013916 0.15887784957885742
2.61848783493042 0.11726951599121094
Epoch: [0][10/69]	Time  0.24 ( 0.41)	Data  0.09 ( 0.17)	Loss   2.74 (  2.83)
2.4398276805877686 0.1287550926208496
2.4952359199523926 0.12167739868164062
2.3239166736602783 0.12473630905151367
2.1068170070648193 0.14438390731811523
2.4180808067321777 0.14862298965454102
2.3471970558166504 0.11984109878540039
2.24784255027771 0.1708235740661621
2.072866439819336 0.14854001998901367
2.101447582244873 0.21054863929748535
2.1157870292663574 0.2496204376220703
Epoch: [0][20/69]	Time  0.24 ( 0.33)	Data  0.09 ( 0.13)	Loss   2.37 (  2.64)
2.086228609085083 0.23055624961853027
1.916535496711731 0.21489667892456055
2.237318992614746 0.1478285789489746
2.0783448219299316 0.2033228874206543
2.127563953399658 0.20842504501342773
1.9637371301651 0.26505136489868164
1.808800220489502 0.2526681423187256
1.9231736660003662 0.24730253219604492
1.968658208847046 0.21392202377319336
2.0272376537323 0.2228710651397705
Epoch: [0][30/69]	Time  0.24 ( 0.30)	Data  0.09 ( 0.12)	Loss   2.25 (  2.51)
2.0426111221313477 0.18276309967041016
1.9017390012741089 0.26299166679382324
2.0597352981567383 0.1637716293334961
1.85628342628479 0.23206210136413574
1.913743495941162 0.24377202987670898
1.9626669883728027 0.21000146865844727
1.992086410522461 0.2685668468475342
1.8212007284164429 0.26473402976989746
1.685870885848999 0.3592677116394043
1.7267946004867554 0.3125772476196289
Epoch: [0][40/69]	Time  0.24 ( 0.29)	Data  0.09 ( 0.11)	Loss   2.04 (  2.42)
1.7925093173980713 0.2876009941101074
1.6566829681396484 0.29798460006713867
1.7967116832733154 0.27672481536865234
1.6752660274505615 0.2957887649536133
1.7676160335540771 0.31868410110473633
2.064805746078491 0.19629788398742676
1.6991565227508545 0.27086949348449707
1.7584266662597656 0.2956719398498535
1.7370824813842773 0.28882527351379395
1.6771714687347412 0.3033156394958496
Epoch: [0][50/69]	Time  0.24 ( 0.28)	Data  0.09 ( 0.11)	Loss   1.98 (  2.35)
1.794079303741455 0.2618377208709717
1.7338308095932007 0.3470890522003174
1.6578677892684937 0.2851839065551758
1.9351699352264404 0.2491762638092041
1.7334424257278442 0.29550886154174805
1.6224360466003418 0.3144400119781494
1.7509605884552002 0.3312358856201172
1.6528995037078857 0.2982945442199707
1.6087676286697388 0.3247361183166504
1.6983916759490967 0.28137898445129395
Epoch: [0][60/69]	Time  0.24 ( 0.27)	Data  0.09 ( 0.10)	Loss   1.98 (  2.29)
1.6945278644561768 0.27046823501586914
1.7450299263000488 0.28192830085754395
1.5986629724502563 0.3042140007019043
1.5917484760284424 0.28083086013793945
1.716647744178772 0.2683281898498535
1.6636077165603638 0.3672356605529785
1.5976630449295044 0.32285428047180176
1.71016526222229 0.610121488571167
Test: [ 0/69]	Time  0.953 ( 0.953)	Loss 3.2770e+00 (3.2770e+00)	Acc@1  28.12 ( 28.12)
Test: [10/69]	Time  0.082 ( 0.166)	Loss 1.5043e+00 (2.2215e+00)	Acc@1  70.31 ( 51.28)
Test: [20/69]	Time  0.080 ( 0.126)	Loss 6.0450e-01 (2.4880e+00)	Acc@1  81.25 ( 45.16)
Test: [30/69]	Time  0.083 ( 0.112)	Loss 1.5649e+00 (2.5282e+00)	Acc@1  62.50 ( 45.26)
Test: [40/69]	Time  0.083 ( 0.105)	Loss 2.0484e+00 (2.4638e+00)	Acc@1  54.69 ( 46.95)
Test: [50/69]	Time  0.079 ( 0.101)	Loss 1.2560e+00 (2.4520e+00)	Acc@1  75.00 ( 47.64)
Test: [60/69]	Time  0.081 ( 0.097)	Loss 2.9137e+00 (2.4415e+00)	Acc@1  25.00 ( 47.69)
 * Acc@1 46.552
lr: [0.0006817316198804998, 0.006817316198804997]
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 355, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 127, in main
    train_target(train_loader, classifier, optimizer, lr_scheduler, epoch, args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 244, in train_target
    pesudo_labels = collect_pseudo_labels(train_loader, model, args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 157, in collect_pseudo_labels
    feature_list.append(f.detach().cpu())
KeyboardInterrupt
