Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
lr: 0.01
2.839700698852539 0.0709385871887207
Epoch: [0][ 0/69]	Time  2.18 ( 2.18)	Data  1.03 ( 1.03)	Loss   2.91 (  2.91)
2.8020496368408203 0.1118311882019043
3.022202253341675 0.050366878509521484
2.7623696327209473 0.09425687789916992
2.806619644165039 0.06872940063476562
2.5001697540283203 0.1228032112121582
2.565486431121826 0.09697675704956055
2.6100523471832275 0.12277030944824219
2.812717914581299 0.07904624938964844
2.7277510166168213 0.09003210067749023
2.5539417266845703 0.11085176467895508
Epoch: [0][10/69]	Time  0.25 ( 0.42)	Data  0.09 ( 0.17)	Loss   2.66 (  2.82)
2.4333369731903076 0.11501836776733398
2.5627212524414062 0.11369562149047852
2.485379695892334 0.11259031295776367
2.306720018386841 0.10844564437866211
2.2908477783203125 0.16907358169555664
2.160139322280884 0.18180537223815918
2.3600025177001953 0.1541275978088379
2.2447919845581055 0.18929100036621094
2.293405055999756 0.12630128860473633
2.25400447845459 0.17191743850708008
Epoch: [0][20/69]	Time  0.25 ( 0.33)	Data  0.09 ( 0.13)	Loss   2.43 (  2.66)
2.098845958709717 0.24056768417358398
2.1639559268951416 0.1698603630065918
2.1168925762176514 0.1750800609588623
2.1504852771759033 0.1946549415588379
1.9703806638717651 0.21430635452270508
2.113107681274414 0.17834734916687012
2.136477470397949 0.20252180099487305
1.9953863620758057 0.23553228378295898
1.9142580032348633 0.2305002212524414
1.9395956993103027 0.26775550842285156
Epoch: [0][30/69]	Time  0.25 ( 0.31)	Data  0.09 ( 0.12)	Loss   2.21 (  2.53)
2.07759952545166 0.20464348793029785
1.869359016418457 0.2454690933227539
2.0027554035186768 0.20513343811035156
2.1050772666931152 0.17635512351989746
1.8174662590026855 0.2503390312194824
1.8879389762878418 0.21607589721679688
1.8131526708602905 0.22365093231201172
1.6388657093048096 0.27052974700927734
1.903017520904541 0.20694828033447266
2.0160441398620605 0.21033000946044922
Epoch: [0][40/69]	Time  0.25 ( 0.29)	Data  0.09 ( 0.11)	Loss   2.23 (  2.44)
1.8704469203948975 0.2558159828186035
1.8698511123657227 0.2342069149017334
1.8775241374969482 0.20494985580444336
1.889939785003662 0.2624690532684326
1.9258332252502441 0.2406473159790039
1.8193962574005127 0.27544355392456055
1.8324134349822998 0.20972061157226562
1.8596128225326538 0.26674389839172363
1.8180251121520996 0.24472332000732422
1.7536484003067017 0.2375490665435791
Epoch: [0][50/69]	Time  0.25 ( 0.28)	Data  0.09 ( 0.11)	Loss   1.99 (  2.37)
1.677504062652588 0.342897891998291
1.7586170434951782 0.2835512161254883
1.6255698204040527 0.37236452102661133
1.7321288585662842 0.25907468795776367
1.6215728521347046 0.2601184844970703
1.7541242837905884 0.30032992362976074
1.6697466373443604 0.3195767402648926
1.8207192420959473 0.2564563751220703
1.707984209060669 0.2642335891723633
1.8052831888198853 0.2573096752166748
Epoch: [0][60/69]	Time  0.25 ( 0.28)	Data  0.09 ( 0.11)	Loss   2.06 (  2.31)
1.5874958038330078 0.272291898727417
1.7976031303405762 0.2562222480773926
1.6295685768127441 0.33231306076049805
1.5995815992355347 0.3529505729675293
1.6672489643096924 0.3024177551269531
1.5609549283981323 0.3349478244781494
1.481006383895874 0.2936210632324219
1.660180926322937 0.6473779678344727
Test: [ 0/69]	Time  1.085 ( 1.085)	Loss 2.8591e+00 (2.8591e+00)	Acc@1  26.56 ( 26.56)
Test: [10/69]	Time  0.087 ( 0.178)	Loss 1.1218e+00 (2.1320e+00)	Acc@1  73.44 ( 50.00)
Test: [20/69]	Time  0.083 ( 0.135)	Loss 7.5968e-01 (2.1695e+00)	Acc@1  82.81 ( 49.40)
Test: [30/69]	Time  0.084 ( 0.119)	Loss 1.5742e+00 (2.3523e+00)	Acc@1  59.38 ( 47.68)
Test: [40/69]	Time  0.087 ( 0.110)	Loss 2.1253e+00 (2.3137e+00)	Acc@1  51.56 ( 48.78)
Test: [50/69]	Time  0.086 ( 0.106)	Loss 1.3104e+00 (2.3048e+00)	Acc@1  70.31 ( 49.63)
Test: [60/69]	Time  0.083 ( 0.103)	Loss 2.5486e+00 (2.2629e+00)	Acc@1  35.94 ( 50.28)
 * Acc@1 50.034
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 355, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 133, in main
    torch.save(classifier.state_dict(), logger.get_checkpoint_path('latest'))
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/serialization.py", line 380, in save
    return
  File "/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
KeyboardInterrupt
