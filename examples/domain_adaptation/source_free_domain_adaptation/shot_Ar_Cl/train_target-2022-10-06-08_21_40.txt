Namespace(root='/data/office-home/', data='OfficeHome', domain=['Cl'], val_ratio=0.0, train_resizing='ran.crop', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, wn=False, scratch=False, load='./shot_Ar/checkpoints/best.pth', batch_size=64, lr=0.01, lr_gamma=10, lr_decay=0.75, momentum=0.9, weight_decay=0.001, epsilon=1e-05, lb_smooth=0.1, trade_off=0.0, workers=8, epochs=15, print_freq=10, seed=None, per_class_eval=False, log='./shot_Ar_Cl/', phase='train_target')
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomCrop(size=(224, 224), padding=None)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
/home/guoxingzhuo/anaconda3/lib/python3.9/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and will be removed in 0.15. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
[Parameter containing:
tensor([[ 0.0079, -0.0205, -0.0082,  ...,  0.0106, -0.0058,  0.0158],
        [-0.0126,  0.0039, -0.0058,  ...,  0.0125,  0.0067,  0.0074],
        [ 0.0173, -0.0292,  0.0139,  ..., -0.0188,  0.0013, -0.0029],
        ...,
        [-0.0001, -0.0230, -0.0074,  ..., -0.0059, -0.0164, -0.0124],
        [ 0.0102, -0.0150, -0.0085,  ..., -0.0044,  0.0043,  0.0099],
        [-0.0079,  0.0065, -0.0160,  ..., -0.0122, -0.0064, -0.0173]],
       device='cuda:0', requires_grad=True), Parameter containing:
tensor([-3.8169e-03,  3.5450e-03, -2.0171e-02, -1.0080e-02,  1.5178e-02,
        -2.1366e-02, -1.2550e-02,  7.5760e-03, -1.9217e-02,  1.2245e-02,
         6.1761e-03,  6.1776e-03,  1.8348e-02,  1.4480e-02, -4.3633e-03,
        -8.0507e-03,  6.1931e-03,  1.9505e-02,  5.0130e-03,  6.8743e-03,
        -2.0955e-02,  1.7989e-02, -1.7132e-02,  2.0862e-02,  7.3499e-03,
        -3.9623e-04, -1.0933e-02,  1.7620e-02, -8.6662e-03,  1.9331e-02,
        -1.0625e-02, -6.7256e-03,  5.0047e-03, -4.5441e-03, -1.0976e-02,
         2.5282e-03, -7.7536e-04,  1.7231e-03, -1.2726e-02, -1.3207e-02,
        -1.4298e-02, -1.7296e-02, -1.7882e-02,  1.8137e-02, -1.7605e-02,
         1.7434e-02, -3.5985e-03, -1.6177e-02,  5.6021e-03,  1.1701e-02,
        -3.2162e-03, -5.3696e-03,  1.7258e-02, -1.9006e-02,  4.4353e-03,
         2.1498e-03, -9.7703e-03, -1.8680e-02,  1.3244e-02, -7.5327e-04,
        -5.5659e-03,  4.3523e-03, -1.8478e-02, -6.0511e-03, -1.1616e-02,
         9.2639e-03, -1.7304e-02,  9.1576e-03,  6.9927e-03, -1.4918e-02,
        -9.1809e-04,  4.9162e-03, -2.6143e-05,  1.3417e-02, -7.2876e-05,
        -1.7152e-02,  1.4623e-02, -1.1141e-03,  2.0783e-02, -4.4591e-03,
        -1.2402e-03,  1.4306e-03,  1.0278e-02, -2.0494e-02,  1.0376e-02,
         1.5815e-02,  4.1868e-03,  1.6466e-02,  9.3849e-03, -1.3986e-03,
        -4.5923e-03,  1.9137e-02,  1.3297e-02,  6.6983e-03,  7.8907e-03,
         8.7598e-03, -5.4731e-03, -1.1175e-02,  4.1003e-04,  7.1094e-03,
         1.6103e-02, -1.7711e-02, -2.5918e-03,  1.1278e-03,  1.6659e-02,
        -2.5251e-03,  1.3836e-02, -6.4579e-03, -4.6067e-03, -6.3364e-03,
         2.0619e-02, -2.0244e-02, -6.2422e-03, -1.1927e-02,  5.0359e-04,
        -6.0607e-03,  1.9278e-02, -6.0533e-03, -8.9073e-03, -1.5946e-02,
         3.3773e-03, -6.3611e-03, -2.5472e-03,  1.5229e-02, -7.3090e-03,
        -6.3273e-03,  1.5904e-02,  7.5575e-05, -2.5824e-05,  4.9938e-03,
        -5.7932e-03, -2.1001e-02, -4.1897e-03, -2.1468e-02,  3.6813e-05,
         3.2515e-03, -1.1660e-02, -2.0325e-02,  9.7508e-03, -1.5799e-02,
        -1.1661e-02,  2.4962e-03,  5.3993e-03,  7.7297e-03, -1.8627e-02,
        -1.8523e-02,  1.5141e-03,  1.1425e-02, -5.7621e-04,  1.3799e-02,
         1.7227e-02, -3.3545e-03, -1.8755e-04, -2.1631e-02,  7.4041e-03,
         1.4374e-02,  3.0151e-03, -1.9829e-02,  7.7731e-03,  1.1362e-02,
         1.3608e-02, -3.1239e-03, -1.9071e-02,  2.1373e-02, -7.9637e-03,
        -9.6095e-03,  4.7191e-03, -2.0127e-02,  1.0143e-02, -1.8066e-02,
        -1.1117e-03, -1.0375e-02, -2.0074e-02,  1.8077e-03, -1.6692e-02,
         2.0242e-03,  1.6545e-02,  6.1756e-03,  5.4416e-03, -6.7382e-03,
         1.3620e-02, -1.7897e-02,  5.8059e-03,  1.0678e-02,  1.5755e-02,
        -1.0099e-02,  1.9253e-02,  7.8080e-03, -3.7497e-04, -1.1313e-02,
        -4.6205e-03, -7.9854e-03,  5.0838e-03,  1.8611e-02, -5.7666e-03,
        -1.7141e-03,  1.9812e-03, -3.1262e-03, -3.3175e-03,  1.4855e-02,
        -5.2885e-04,  1.2962e-02,  1.2764e-02,  3.0910e-03,  1.3809e-02,
         2.0449e-03, -1.3884e-02,  8.1270e-04,  4.5635e-03,  6.0283e-03,
         7.8410e-03,  1.9382e-02, -1.7451e-02,  1.6008e-02,  1.8619e-02,
        -1.1014e-02,  1.9156e-02,  2.1264e-02,  1.2294e-02, -1.2784e-02,
        -4.4868e-03,  9.7601e-03, -1.1707e-02,  7.4168e-03, -1.3898e-02,
         1.6435e-02, -1.7836e-02,  2.0962e-02, -6.3442e-03,  9.5113e-03,
        -8.0896e-03,  1.7506e-02,  4.8630e-03,  1.0860e-02, -7.8749e-03,
         1.9963e-02,  1.5140e-02,  1.5643e-02, -1.9481e-02, -1.9915e-02,
         7.4854e-03, -5.6488e-03, -1.3222e-02, -1.6446e-02, -6.2746e-03,
        -1.2398e-06, -8.7904e-03,  8.8391e-04, -1.0454e-02,  2.1303e-02,
        -1.2739e-03, -4.4099e-03, -7.6282e-03,  1.6356e-02, -1.8079e-02,
        -9.5811e-03], device='cuda:0', requires_grad=True), Parameter containing:
tensor([1.0227, 1.0319, 1.0256, 1.0207, 1.0289, 1.0284, 1.0195, 1.0194, 1.0524,
        1.0208, 1.0179, 1.0367, 1.0218, 1.0239, 1.0294, 1.0256, 1.0273, 1.0196,
        1.0179, 1.0208, 1.0189, 1.0349, 1.0291, 1.0323, 1.0210, 1.0368, 1.0192,
        1.0356, 1.0222, 1.0306, 1.0273, 1.0144, 1.0263, 1.0410, 1.0198, 1.0203,
        1.0204, 1.0279, 1.0255, 1.0209, 1.0366, 1.0193, 1.0287, 1.0318, 1.0134,
        1.0395, 1.0312, 1.0249, 1.0205, 1.0263, 1.0205, 1.0260, 1.0397, 1.0248,
        1.0238, 1.0232, 1.0242, 1.0305, 1.0265, 1.0332, 1.0285, 1.0194, 1.0227,
        1.0228, 1.0358, 1.0265, 1.0179, 1.0298, 1.0442, 1.0315, 1.0283, 1.0153,
        1.0307, 1.0248, 1.0318, 1.0245, 1.0225, 1.0264, 1.0227, 1.0110, 1.0290,
        1.0183, 1.0206, 1.0303, 1.0123, 1.0175, 1.0238, 1.0226, 1.0329, 1.0223,
        1.0387, 1.0178, 1.0311, 1.0284, 1.0340, 1.0221, 1.0217, 1.0182, 1.0256,
        1.0195, 1.0335, 1.0241, 1.0433, 1.0360, 1.0162, 1.0268, 1.0264, 1.0239,
        1.0254, 1.0347, 1.0442, 1.0282, 1.0271, 1.0256, 1.0217, 1.0184, 1.0267,
        1.0312, 1.0250, 1.0285, 1.0216, 1.0257, 1.0348, 1.0269, 1.0238, 1.0344,
        1.0341, 1.0338, 1.0189, 1.0174, 1.0211, 1.0291, 1.0314, 1.0214, 1.0339,
        1.0226, 1.0316, 1.0227, 1.0310, 1.0381, 1.0263, 1.0249, 1.0259, 1.0245,
        1.0274, 1.0412, 1.0291, 1.0339, 1.0174, 1.0248, 1.0414, 1.0255, 1.0258,
        1.0326, 1.0234, 1.0268, 1.0184, 1.0267, 1.0301, 1.0257, 1.0245, 1.0364,
        1.0261, 1.0258, 1.0174, 1.0218, 1.0312, 1.0252, 1.0255, 1.0169, 1.0171,
        1.0243, 1.0216, 1.0292, 1.0204, 1.0169, 1.0160, 1.0330, 1.0329, 1.0317,
        1.0193, 1.0103, 1.0252, 1.0220, 1.0205, 1.0202, 1.0225, 1.0216, 1.0256,
        1.0304, 1.0390, 1.0291, 1.0461, 1.0192, 1.0289, 1.0315, 1.0262, 1.0207,
        1.0306, 1.0392, 1.0113, 1.0283, 1.0170, 1.0382, 1.0251, 1.0198, 1.0367,
        1.0352, 1.0286, 1.0243, 1.0298, 1.0297, 1.0283, 1.0389, 1.0337, 1.0277,
        1.0101, 1.0157, 1.0232, 1.0391, 1.0220, 1.0388, 1.0209, 1.0199, 1.0191,
        1.0321, 1.0316, 1.0379, 1.0235, 1.0266, 1.0451, 1.0149, 1.0336, 1.0259,
        1.0221, 1.0130, 1.0273, 1.0304, 1.0257, 1.0268, 1.0271, 1.0141, 1.0238,
        1.0186, 1.0273, 1.0272, 1.0154, 1.0309, 1.0234, 1.0163, 1.0210, 1.0332,
        1.0261, 1.0355, 1.0272, 1.0235], device='cuda:0', requires_grad=True), Parameter containing:
tensor([0.0242, 0.0383, 0.0327, 0.0318, 0.0339, 0.0335, 0.0296, 0.0243, 0.0389,
        0.0293, 0.0256, 0.0307, 0.0247, 0.0274, 0.0299, 0.0298, 0.0337, 0.0192,
        0.0262, 0.0201, 0.0231, 0.0299, 0.0305, 0.0364, 0.0246, 0.0372, 0.0262,
        0.0349, 0.0240, 0.0262, 0.0264, 0.0208, 0.0278, 0.0335, 0.0254, 0.0239,
        0.0276, 0.0259, 0.0172, 0.0261, 0.0349, 0.0270, 0.0259, 0.0243, 0.0181,
        0.0356, 0.0353, 0.0226, 0.0260, 0.0275, 0.0258, 0.0321, 0.0284, 0.0264,
        0.0274, 0.0219, 0.0266, 0.0289, 0.0282, 0.0341, 0.0325, 0.0286, 0.0305,
        0.0196, 0.0303, 0.0286, 0.0218, 0.0371, 0.0356, 0.0345, 0.0274, 0.0213,
        0.0346, 0.0247, 0.0353, 0.0235, 0.0266, 0.0299, 0.0239, 0.0192, 0.0312,
        0.0218, 0.0264, 0.0346, 0.0196, 0.0234, 0.0278, 0.0220, 0.0336, 0.0195,
        0.0368, 0.0204, 0.0288, 0.0296, 0.0360, 0.0280, 0.0265, 0.0250, 0.0247,
        0.0177, 0.0301, 0.0239, 0.0353, 0.0360, 0.0215, 0.0322, 0.0239, 0.0313,
        0.0295, 0.0282, 0.0350, 0.0316, 0.0302, 0.0283, 0.0294, 0.0208, 0.0366,
        0.0277, 0.0237, 0.0334, 0.0255, 0.0289, 0.0307, 0.0268, 0.0170, 0.0293,
        0.0287, 0.0324, 0.0246, 0.0244, 0.0272, 0.0293, 0.0313, 0.0284, 0.0303,
        0.0257, 0.0297, 0.0246, 0.0315, 0.0319, 0.0247, 0.0275, 0.0258, 0.0256,
        0.0292, 0.0408, 0.0332, 0.0296, 0.0266, 0.0259, 0.0339, 0.0284, 0.0197,
        0.0312, 0.0229, 0.0300, 0.0247, 0.0305, 0.0325, 0.0308, 0.0244, 0.0325,
        0.0355, 0.0325, 0.0212, 0.0265, 0.0259, 0.0248, 0.0268, 0.0187, 0.0218,
        0.0252, 0.0259, 0.0271, 0.0256, 0.0182, 0.0188, 0.0305, 0.0256, 0.0296,
        0.0303, 0.0209, 0.0250, 0.0266, 0.0228, 0.0212, 0.0276, 0.0308, 0.0325,
        0.0358, 0.0297, 0.0315, 0.0399, 0.0267, 0.0319, 0.0357, 0.0259, 0.0274,
        0.0369, 0.0329, 0.0205, 0.0327, 0.0203, 0.0351, 0.0299, 0.0281, 0.0330,
        0.0329, 0.0313, 0.0276, 0.0288, 0.0310, 0.0265, 0.0376, 0.0256, 0.0258,
        0.0176, 0.0222, 0.0281, 0.0328, 0.0222, 0.0372, 0.0239, 0.0205, 0.0255,
        0.0326, 0.0377, 0.0314, 0.0248, 0.0283, 0.0370, 0.0196, 0.0375, 0.0318,
        0.0294, 0.0227, 0.0295, 0.0305, 0.0337, 0.0370, 0.0288, 0.0176, 0.0246,
        0.0248, 0.0294, 0.0301, 0.0246, 0.0290, 0.0280, 0.0215, 0.0233, 0.0353,
        0.0290, 0.0325, 0.0295, 0.0281], device='cuda:0', requires_grad=True)]
3.0246996879577637 0.05851888656616211
Epoch: [0][ 0/69]	Time  2.04 ( 2.04)	Data  0.89 ( 0.89)	Loss   3.08 (  3.08)
2.707214117050171 0.0964193344116211
3.0566625595092773 0.05726003646850586
2.652477264404297 0.09786558151245117
2.731029987335205 0.07594060897827148
2.854846954345703 0.09674215316772461
2.784076690673828 0.09459590911865234
2.7590062618255615 0.08872079849243164
2.6864469051361084 0.09513711929321289
2.7216649055480957 0.09166574478149414
2.6937685012817383 0.08950185775756836
Epoch: [0][10/69]	Time  0.24 ( 0.40)	Data  0.10 ( 0.16)	Loss   2.78 (  2.87)
2.6772046089172363 0.08258056640625
2.7825467586517334 0.08801651000976562
2.668755054473877 0.12920331954956055
2.458831787109375 0.14718055725097656
2.496293783187866 0.09400320053100586
2.5780200958251953 0.11847829818725586
2.487084150314331 0.13302326202392578
2.3743865489959717 0.13680696487426758
2.5911107063293457 0.1466202735900879
2.3110008239746094 0.15086126327514648
Epoch: [0][20/69]	Time  0.24 ( 0.33)	Data  0.10 ( 0.13)	Loss   2.46 (  2.77)
2.5617146492004395 0.1346454620361328
2.472217559814453 0.15963411331176758
2.5710248947143555 0.11507081985473633
2.4600305557250977 0.1600794792175293
Traceback (most recent call last):
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 355, in <module>
    main(args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 127, in main
    train_target(train_loader, classifier, optimizer, lr_scheduler, epoch, args)
  File "/workspace/guoxingzhuo/Transfer-Learning-Library/examples/domain_adaptation/source_free_domain_adaptation/shot.py", line 266, in train_target
    print(entropy_loss.item(), divergence_loss.item())
KeyboardInterrupt
